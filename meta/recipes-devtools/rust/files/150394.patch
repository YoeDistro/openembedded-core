From 634251cba8edb4ebcd01e330c7241e14d76322a1 Mon Sep 17 00:00:00 2001
From: Devon Loehr <dloehr@google.com>
Date: Fri, 26 Dec 2025 15:40:40 +0000
Subject: [PATCH] Accommodate upstream PassPlugin rename

Upstream-Status: Submitted [https://github.com/rust-lang/rust/pull/150394]
Signed-off-by: Khem Raj <raj.khem@gmail.com>
---
 compiler/rustc_llvm/llvm-wrapper/PassWrapper.cpp | 4 ++++
 1 file changed, 4 insertions(+)

--- a/compiler/rustc_llvm/llvm-wrapper/PassWrapper.cpp
+++ b/compiler/rustc_llvm/llvm-wrapper/PassWrapper.cpp
@@ -20,7 +20,11 @@
 #include "llvm/MC/TargetRegistry.h"
 #include "llvm/Object/ObjectFile.h"
 #include "llvm/Passes/PassBuilder.h"
+#if LLVM_VERSION_GE(22, 0)
+#include "llvm/Plugins/PassPlugin.h"
+#else
 #include "llvm/Passes/PassPlugin.h"
+#endif
 #include "llvm/Passes/StandardInstrumentations.h"
 #include "llvm/Support/CBindingWrapping.h"
 #include "llvm/Support/FileSystem.h"
